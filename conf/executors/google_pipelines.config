docker.enabled = true

google {
    lifeSciences.bootDiskSize = 100.GB
    lifeSciences.preemptible = false
    zone = 'us-east1-b'
    network = 'jax-poc-lifebit-01-vpc-network'
    subnetwork = 'us-east1-sub2'
}

executor {
  name = 'google-lifesciences'
}

cloud {
    preemptible = false
    autoscale {
        enable = true
        preemptible = false
        terminateWhenIdle = true
    }
}

// preemptiblea error strategy: https://cloud.google.com/life-sciences/docs/troubleshooting#retrying_after_encountering_errors
process {
    errorStrategy = { task.exitStatus in [3,8,10,14] ||  task.attempt <=  6 ? 'retry' : 'ignore' }
    maxRetries = 20
    disk = "200 GB"

    withName:runNotebook {
      cpus = 8
    }

    withName:ontologizer {
      container = 'cyverseuk/ontologizer'
      cpus = 4
    }
}
